import{u as _,r as m,o as h,c as v,e as t,i as y,k as n,v as d,t as f,A as c,d as b}from"./app-E0SyKMCT.js";const k={class:"space-y-6"},U={class:"card p-6 bg-white"},V={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j={class:"flex justify-end"},q=["disabled"],P={class:"card p-6 bg-white"},S={class:"flex items-center gap-4"},A={class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-xl font-bold text-gray-500 overflow-hidden"},D=["src"],B={key:1},M={class:"card p-6 bg-white"},C={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},F={class:"flex justify-end"},G=["disabled"],J={__name:"Edit",setup(N){const i=_(),u=m(!1),p=m(!1),a=m({name:"",email:"",phone:"",avatar_url:""}),l=m({current_password:"",password:"",password_confirmation:""});h(()=>{i.user&&(a.value.name=i.user.name,a.value.email=i.user.email,a.value.phone=i.user.phone||"",a.value.avatar_url=i.user.avatar_url)});const g=async()=>{var r,e;u.value=!0;try{await i.updateProfile({name:a.value.name,email:a.value.email,phone:a.value.phone}),alert("تم تحديث المعلومات بنجاح")}catch(o){alert(((e=(r=o.response)==null?void 0:r.data)==null?void 0:e.message)||"فشل التحديث")}finally{u.value=!1}},x=async()=>{var r,e;p.value=!0;try{await c.put("/me/password",l.value),await c.put("/me",{...l.value}),alert("تم تغيير كلمة المرور"),l.value={current_password:"",password:"",password_confirmation:""}}catch(o){alert(((e=(r=o.response)==null?void 0:r.data)==null?void 0:e.message)||"فشل تغيير كلمة المرور")}finally{p.value=!1}},w=async r=>{const e=r.target.files[0];if(!e)return;const o=new FormData;o.append("avatar",e);try{const s=await c.post("/me/avatar",o,{headers:{"Content-Type":"multipart/form-data"}});a.value.avatar_url=s.data.avatar_url,await i.fetchUser(),alert("تم رفع الصورة")}catch{alert("فشل رفع الصورة")}};return(r,e)=>{var o;return b(),v("div",k,[e[16]||(e[16]=t("div",{class:"flex items-center justify-between"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"الملف الشخصي")],-1)),t("div",U,[e[9]||(e[9]=t("h2",{class:"text-lg font-bold text-gray-900 mb-4"},"المعلومات الشخصية",-1)),t("form",{onSubmit:y(g,["prevent"]),class:"space-y-4"},[t("div",V,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"الاسم الكامل",-1)),n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.name=s),type:"text",required:"",class:"input"},null,512),[[d,a.value.name]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"البريد الإلكتروني",-1)),n(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.email=s),type:"email",required:"",class:"input"},null,512),[[d,a.value.email]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"رقم الهاتف",-1)),n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.phone=s),type:"text",class:"input",placeholder:"اختياري"},null,512),[[d,a.value.phone]])])]),t("div",j,[t("button",{type:"submit",disabled:u.value,class:"btn btn-primary"},f(u.value?"جاري الحفظ...":"حفظ التغييرات"),9,q)])],32)]),t("div",P,[e[11]||(e[11]=t("h2",{class:"text-lg font-bold text-gray-900 mb-4"},"الصورة الرمزية",-1)),t("div",S,[t("div",A,[a.value.avatar_url?(b(),v("img",{key:0,src:a.value.avatar_url,class:"w-full h-full object-cover"},null,8,D)):(b(),v("span",B,f((o=a.value.name)==null?void 0:o.charAt(0)),1))]),t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm text-gray-600 mb-2"},"قم برفع صورة جديدة (JPG, PNG)",-1)),t("input",{type:"file",onChange:w,accept:"image/*",class:"text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"},null,32)])])]),t("div",M,[e[15]||(e[15]=t("h2",{class:"text-lg font-bold text-gray-900 mb-4"},"الأمان",-1)),t("form",{onSubmit:y(x,["prevent"]),class:"space-y-4"},[t("div",C,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"كلمة المرور الحالية",-1)),n(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.current_password=s),type:"password",required:"",class:"input"},null,512),[[d,l.value.current_password]])])]),t("div",E,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"كلمة المرور الجديدة",-1)),n(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.password=s),type:"password",required:"",class:"input"},null,512),[[d,l.value.password]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"تأكيد كلمة المرور",-1)),n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.password_confirmation=s),type:"password",required:"",class:"input"},null,512),[[d,l.value.password_confirmation]])])]),t("div",F,[t("button",{type:"submit",disabled:p.value,class:"btn btn-secondary"},f(p.value?"جاري التحديث...":"تحديث كلمة المرور"),9,G)])],32)])])}}};export{J as default};
