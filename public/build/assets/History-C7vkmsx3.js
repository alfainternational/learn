import{r as c,q as g,o as k,c as o,e as t,f as C,w as D,b as S,t as l,j as x,F as y,x as m,A as F,d as r,g as h,n as _}from"./app-E0SyKMCT.js";const L={class:"space-y-6"},N={class:"flex items-center justify-between"},T={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},V={class:"card p-4 bg-white"},j={class:"text-2xl font-bold text-gray-900 mt-2"},A={class:"card p-4 bg-white"},B={class:"text-xl font-bold text-gray-900 mt-2"},H={class:"card bg-white overflow-hidden"},M={class:"overflow-x-auto"},P={class:"min-w-full divide-y divide-gray-200"},$={class:"bg-white divide-y divide-gray-200"},q={key:0},z={key:1},E={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},I={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},G={key:0,class:"text-xs text-gray-400"},J={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},K={class:"px-6 py-4 whitespace-nowrap"},O={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Q=["onClick"],R={key:0,class:"px-6 py-4 border-t border-gray-200 flex justify-center"},U={class:"flex gap-1"},W=["disabled","onClick","innerHTML"],tt={__name:"History",setup(X){const n=c([]),d=c([]),i=c(!0),v=g(()=>n.value.filter(a=>a.status==="completed").reduce((a,e)=>a+parseFloat(e.amount),0).toFixed(2)),f=g(()=>{const a=n.value.filter(e=>e.status==="completed");return a.length===0?"-":new Date(a[0].created_at).toLocaleDateString("ar-SA")}),p=async(a="/transactions")=>{i.value=!0;try{const e=await F.get(a);n.value=e.data.data.data,d.value=e.data.data.links}catch(e){console.error(e)}finally{i.value=!1}},w=a=>{alert("سيتم تفعيل تحميل الفاتورة قريباً")};return k(()=>{p()}),(a,e)=>{const b=S("router-link");return r(),o("div",L,[t("div",N,[e[1]||(e[1]=t("h1",{class:"text-2xl font-bold text-gray-900"},"سجل الاشتراكات والمدفوعات",-1)),C(b,{to:"/subscription",class:"text-sm text-primary-600 hover:underline"},{default:D(()=>[...e[0]||(e[0]=[h(" ← إدارة الباقات ",-1)])]),_:1})]),t("div",T,[t("div",V,[e[2]||(e[2]=t("h3",{class:"text-sm font-medium text-gray-500"},"إجمالي المدفوعات",-1)),t("p",j,l(v.value)+" ريال",1)]),t("div",A,[e[3]||(e[3]=t("h3",{class:"text-sm font-medium text-gray-500"},"آخر عملية دقع",-1)),t("p",B,l(f.value),1)]),e[4]||(e[4]=t("div",{class:"card p-4 bg-white"},[t("h3",{class:"text-sm font-medium text-gray-500"},"الحالة الحالية"),t("p",{class:"text-xl font-bold text-green-600 mt-2"},"نشط")],-1))]),t("div",H,[t("div",M,[t("table",P,[e[7]||(e[7]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"التاريخ"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"الوصف"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"المبلغ"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"الحالة"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"الفاتورة")])],-1)),t("tbody",$,[i.value?(r(),o("tr",q,[...e[5]||(e[5]=[t("td",{colspan:"5",class:"px-6 py-10 text-center text-gray-500"},"جاري التحميل...",-1)])])):n.value.length===0?(r(),o("tr",z,[...e[6]||(e[6]=[t("td",{colspan:"5",class:"px-6 py-10 text-center text-gray-500"},"لا توجد معاملات سابقة",-1)])])):x("",!0),(r(!0),o(y,null,m(n.value,s=>(r(),o("tr",{key:s.id},[t("td",E,l(new Date(s.created_at).toLocaleDateString("ar-SA")),1),t("td",I,[h(l(s.type==="subscription"?"اشتراك شهري":"عملية شراء")+" ",1),s.payment_method?(r(),o("span",G,"("+l(s.payment_method)+")",1)):x("",!0)]),t("td",J,l(s.amount)+" "+l(s.currency),1),t("td",K,[t("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":s.status==="completed","bg-yellow-100 text-yellow-800":s.status==="pending","bg-red-100 text-red-800":s.status==="failed"}])},l(s.status==="completed"?"ناجحة":s.status==="pending"?"قيد المعالجة":"فشلت"),3)]),t("td",O,[t("button",{onClick:u=>w(),class:"text-primary-600 hover:text-primary-900"}," تحميل PDF ",8,Q)])]))),128))])])]),d.value.length>3?(r(),o("div",R,[t("nav",U,[(r(!0),o(y,null,m(d.value,(s,u)=>(r(),o("button",{key:u,disabled:!s.url||s.active,onClick:Y=>p(s.url),class:_(["px-3 py-1 text-sm rounded border",s.active?"bg-primary-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"]),innerHTML:s.label},null,10,W))),128))])])):x("",!0)])])}}};export{tt as default};
