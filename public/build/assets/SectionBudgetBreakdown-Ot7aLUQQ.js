import{r as u,o as M,q as y,G as N,y as S,d as i,w as U,e as t,k as m,v as p,n as A,t as v,c as _,F as j,x as D,g as c}from"./app-E0SyKMCT.js";import{_ as I}from"./BaseSection-Ct7qi2nd.js";const L={class:"space-y-6"},T={class:"bg-gray-800 text-white p-6 rounded-2xl flex justify-between items-center"},F={class:"text-3xl font-bold flex items-baseline gap-1"},O={class:"text-right"},$={class:"space-y-3"},q=["onUpdate:modelValue"],z=["onUpdate:modelValue"],E={class:"text-gray-500 text-sm"},G=["onClick"],P={class:"bg-blue-50 p-4 rounded-xl border border-blue-100"},R={class:"flex gap-4 text-sm text-blue-800"},H={class:"flex-1"},J={class:"font-bold border-b border-blue-400"},W={__name:"SectionBudgetBreakdown",props:{modelValue:{type:Object,default:()=>({})},isCompleted:Boolean,saving:Boolean},emits:["update:modelValue","update:isCompleted","save"],setup(b,{emit:C}){const a=b,r=C,o=u({total_budget:0,items:[{category:"إعلانات ممولة",amount:0},{category:"إنتاج محتوى",amount:0},{category:"أدوات واشتراكات",amount:0}]}),n=u(!1),g=u(null);M(()=>{a.modelValue&&(a.modelValue.total_budget!==void 0&&(o.value.total_budget=a.modelValue.total_budget),a.modelValue.items&&Array.isArray(a.modelValue.items)&&(o.value.items=a.modelValue.items)),n.value=a.isCompleted});const x=y(()=>{const s=o.value.items.reduce((e,l)=>e+Number(l.amount||0),0);return Number(o.value.total_budget||0)-s}),V=s=>o.value.total_budget?Math.round(Number(s||0)/o.value.total_budget*100):0,w=y(()=>{const s=Number(o.value.total_budget||0);return s>0?Math.floor(s/50):0}),k=()=>o.value.items.push({category:"",amount:0}),B=s=>o.value.items.splice(s,1);N(()=>a.isCompleted,s=>n.value=s);const h=()=>{g.value=new Date().toLocaleTimeString("ar-SA"),r("update:modelValue",o.value),r("update:isCompleted",n.value),r("save")};return(s,e)=>(i(),S(I,{title:"توزيع الميزانية (Budget Breakdown)",saving:b.saving,"last-saved":g.value,isCompleted:n.value,"onUpdate:isCompleted":e[1]||(e[1]=l=>n.value=l),onSave:h},{default:U(()=>[t("div",L,[t("div",T,[t("div",null,[e[3]||(e[3]=t("h3",{class:"text-gray-400 text-sm mb-1"},"الميزانية الإجمالية الشهرية",-1)),t("div",F,[m(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=l=>o.value.total_budget=l),class:"bg-transparent border-0 border-b border-gray-600 w-32 text-center focus:ring-0 focus:border-white font-mono",placeholder:"0"},null,512),[[p,o.value.total_budget]]),e[2]||(e[2]=t("span",{class:"text-sm font-normal"},"ر.س",-1))])]),t("div",O,[e[4]||(e[4]=t("div",{class:"text-sm text-gray-400"},"المتبقي للتوزيع",-1)),t("div",{class:A(["text-xl font-bold",x.value<0?"text-red-400":"text-green-400"])},v(x.value)+" ر.س ",3)])]),t("div",null,[e[6]||(e[6]=t("h4",{class:"font-bold text-gray-800 mb-4"},"بنود الصرف",-1)),t("div",$,[(i(!0),_(j,null,D(o.value.items,(l,f)=>(i(),_("div",{key:f,class:"flex items-center gap-3"},[m(t("input",{"onUpdate:modelValue":d=>l.category=d,type:"text",class:"input flex-1",placeholder:"البند (مثال: إعلانات انستقرام)"},null,8,q),[[p,l.category]]),m(t("input",{"onUpdate:modelValue":d=>l.amount=d,type:"number",class:"input w-32 text-center",placeholder:"المبلغ"},null,8,z),[[p,l.amount]]),t("span",E,"%"+v(V(l.amount)),1),t("button",{onClick:d=>B(f),class:"text-gray-400 hover:text-red-500"},[...e[5]||(e[5]=[t("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,G)]))),128)),t("button",{onClick:k,class:"text-sm text-primary-600 font-bold flex items-center gap-1 hover:text-primary-700"}," + إضافة بند جديد ")])]),t("div",P,[e[11]||(e[11]=t("h4",{class:"font-bold text-blue-900 mb-2 text-sm"},"توقعات العائد (ROI Calculation)",-1)),t("div",R,[t("div",H,[e[7]||(e[7]=c(" إذا كان متوسط تكلفة العميل (CAC) هو ",-1)),e[8]||(e[8]=t("span",{class:"font-bold"},"50 ر.س",-1)),e[9]||(e[9]=c("، فإن هذه الميزانية ستجلب لك تقريباً ",-1)),t("span",J,v(w.value),1),e[10]||(e[10]=c(" عميل محتمل. ",-1))])])])])]),_:1},8,["saving","last-saved","isCompleted"]))}};export{W as default};
